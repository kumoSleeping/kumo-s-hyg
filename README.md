

# Kumo’s HYG 

> 本项目仅供学习与交流, 请勿使用.

## 依赖安装

```bash
pip install noneprompt
pip install PyYAML
pip install requests
pip install qrcode
pip install loguru
pip install pillow
```

## 运行

```bash
cd <your_project_path>
python -m app
```

## 免责声明
- 本项目仅供学习与交流, 请勿生产环境使用.
- 本项目不用于 "抢票", 下单逻辑与正常购票并无二致.
- 本项目不对任何账号负任何责任.
- 本项目不收集任何信息.
- 本项目不收取任何赞助.
- 本人所有项目都不收取赞助.
- 本项目目前未完成, 存在诸多潜在问题, 请勿使用.

## 须知
1. **必须**先为账号至少设置一个**实名制购票人**, 一个**地址**, 记名票 | 纸质票 | 风控手机验证都将使用地址中存储的信息.
2. **必须**按照 config.yml 中的提示**正确**填写配置文件, 否则可能导致程序无法正常运行, 此方面本脚本不会做任何弱保软检测.

> 本人精力有限, 不按照操作指示的操作, 程序会直接报错.

## 关于操作
本项目使用 [Nonebot](https://nonebot.dev/) 附属库 `noneprompt` 交互辅助配置; 支持通过 `Ctrl + C` 返回上一级菜单.  
生成或选择配置, 确认运行以后, 本项目将进入 `配置文件驱动` 模式.  
在配置运行时, 本项目将沦循监控配置文件的变化, 针对不同的有效改变, 做出不同程度的重载, 时刻保持运行逻辑信息符合配置文件.  

## 关于配置文件

[notepad3](http://www.notepad3.cn/) 是一款快速且轻量级的基于 Scintilla 的文本编辑器, 具有语法突出显示功能. 它的占用极小, 但功能强大, 如果您没有安装过其他编辑器, 可以尝试使用它.  

本项目的特点在于 `配置文件驱动` , 通过 yaml 配置文件来驱动程序的运行, 使用本项目需要了解 [yaml](https://www.runoob.com/w3cnote/yaml-intro.html) 的基本语法.  

```yml
screen_ticket: # 选择票种信息(单选):
  - [0, 0] # 4月16日 11:00-12:30 预约抵扣券 30.0元
  # - [1, 0] # 4月16日 13:00-14:30 预约抵扣券 30.0元

address_index: # 选择记名信息(单选):
  - 0 # kumo 12345678910
  # - 1 #  12345678911

count: 1 # 非实名制演出通过此参数设置购买数量
```
在上面的例子中, 
1. `- [0, 0]` 这句话会被执行, `- ` 代表列表.
2. `# - [1, 0]` 这句话不会被执行, 因为其前有 `# ` , 代表注释.
3. 同理, 地址选择中 `- 0` 这句话会被执行, `# - 1` 这句话不会被执行.
4. `count: 1` 这句话会被执行, 代表购买数量为 1 张.

同时 yml 是一个锁进敏感的语言, 请注意每一行的缩进, 不能随意添加空格.

> 如果某些标注了单选的配置您多选了, 程序会自动选择第一个有效的配置, 所以请一定要注意, 防止买错票种.

## 关于多开
本项目万全支持躲开, 基于 `配置文件驱动` 的设计模式, 您完全可以使用同一代码 / 应用程序 多开, 不需要拷贝一份到别的地方.  

- 提醒您, 自从 2024 bw 以后, 412 错误频繁, 尽量不要多开.  
- 同时提醒, 多开并不能更好抢到票, 这是既定事实; 如果想要提高成功率, 可以试试回流.  

## [x]
- 票种
    - [x] 实名制票
    - [x] 记名票
    - [x] 邮寄
    - [x] 选日期票
    - [ ] 选座票

- 运行
  - [x] 等待开票
  - [x] 直接抢票
  - [x] 回流票
  - [x] 假票检测
  - [ ] 自动弹出支付二维码
  - [ ] 验证码相关
  - [ ] 完善网络错误对策
  - [ ] 完善 412 应对策略

- 配置
  - [x] 从现有配置读取cookie
  - [x] 扫码登录
  - [x] 运行时配置热重载
  - [x] 丰富配置文件的注释信息
  - [ ] 配置文件生成时提供预选择

- 高级功能支持
  - [x] 彩色输出
  - [x] 同程序体多开

# 特别感谢
- [BHYG]()
- [Nonebot](https://nonebot.dev/)



